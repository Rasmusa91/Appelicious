RewriteEngine on

RewriteRule ^index\/?$ index.php

RewriteRule ^([^/\.]+)/?$ index.php?p=$1 [QSA,C]
RewriteRule ^([^/\.]+)/?\?$ index.php?p=$1& [QSA]

RewriteRule ^([^/\.]+)/([^/\.]+)/?$ index.php?p=$1&subp=$2 [QSA,C]
RewriteRule ^([^/\.]+)/([^/\.]+)/?\?$ index.php?p=$1&subp=$2& [QSA]

RewriteRule ^([^/\.]+)/([^/\.]+)/([^/\.]+)/?$ index.php?p=$1&subp=$2&subsubp=$3 [QSA,C]
RewriteRule ^([^/\.]+)/([^/\.]+)/([^/\.]+)/?\?$ index.php?p=$1&subp=$2&subsubp=$3& [QSA]

ErrorDocument 404 "Error, 404"